---
interface KeyPublication {
  title: string
  authors: string
  journal: string
  year: number
  doi: string
  significance: string
  firstAuthor?: boolean
}

interface Props {
  publication: KeyPublication
  number: number
}

const { publication, number } = Astro.props

// Format authors - make Krasting bold/italic
const formatAuthors = (authors: string) => {
  return authors.replace(/(\*?Krasting[^,]*\*?)/g, '<strong class="text-gray-900">$1</strong>')
}
---

<div class="group relative">
  <div class="flex gap-4 py-5 transition-all duration-300 group-hover:translate-x-2">
    <!-- Number -->
    <div class="flex-shrink-0 w-10 pt-1">
      <span class="text-2xl font-bold text-gray-200 group-hover:text-gray-300 transition-colors">
        {number}
      </span>
    </div>

    <!-- Content -->
    <div class="flex-1 bg-white rounded-xl border border-gray-100 p-5 shadow-sm group-hover:shadow-md group-hover:border-gray-200 transition-all duration-300">
      <!-- Header: Year & Journal -->
      <div class="flex flex-wrap items-center gap-3 text-sm text-gray-500 mb-3">
        <span class="inline-flex items-center gap-1.5">
          <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
            <line x1="16" y1="2" x2="16" y2="6"/>
            <line x1="8" y1="2" x2="8" y2="6"/>
            <line x1="3" y1="10" x2="21" y2="10"/>
          </svg>
          <span class="font-medium">{publication.year}</span>
        </span>
        <span class="inline-flex items-center gap-1.5">
          <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
          </svg>
          <span class="italic">{publication.journal}</span>
        </span>
        {publication.firstAuthor && (
          <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-amber-100 text-amber-800 border border-amber-200">
            First Author
          </span>
        )}
      </div>

      <!-- Title -->
      <h4 class="text-base font-semibold text-gray-900 leading-snug mb-2 group-hover:text-blue-700 transition-colors">
        {publication.title}
      </h4>

      <!-- Authors -->
      <p class="text-sm text-gray-600 mb-3" set:html={formatAuthors(publication.authors)} />

      <!-- Significance Statement -->
      <div class="bg-gray-50 rounded-lg p-3 border-l-4 border-blue-500">
        <p class="text-sm text-gray-700 leading-relaxed">
          {publication.significance}
        </p>
      </div>

      <!-- DOI Link -->
      <div class="mt-3">
        <a
          href={`https://doi.org/${publication.doi}`}
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-1.5 text-sm text-blue-600 hover:text-blue-800 transition-colors"
        >
          <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
            <polyline points="15 3 21 3 21 9"/>
            <line x1="10" y1="14" x2="21" y2="3"/>
          </svg>
          View Publication
        </a>
      </div>
    </div>
  </div>

  <!-- Left accent bar -->
  <div class="absolute left-0 top-5 bottom-5 w-1 bg-blue-500 rounded-full scale-y-0 group-hover:scale-y-100 transition-transform duration-300 origin-center"></div>
</div>
